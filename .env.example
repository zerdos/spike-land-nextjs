# Database Configuration
# PostgreSQL connection string format:
# postgresql://USER:PASSWORD@HOST:PORT/DATABASE?schema=SCHEMA
#
# Examples:
# - Local: postgresql://postgres:password@localhost:5432/spike_land?schema=public
# - Supabase: postgresql://postgres:[YOUR-PASSWORD]@db.[PROJECT-REF].supabase.co:5432/postgres
# - Railway: postgresql://postgres:[PASSWORD]@[HOST]:[PORT]/railway
# - Neon: postgresql://[USER]:[PASSWORD]@[HOST]/[DATABASE]?sslmode=require
DATABASE_URL=postgresql://postgres:password@localhost:5432/spike_land?schema=public

# Database Connection Pooling (Production)
# Use connection pooling for serverless/edge environments
# DIRECT_URL is for migrations, DATABASE_URL is for queries
# DIRECT_URL=postgresql://postgres:password@localhost:5432/spike_land?schema=public

# NextAuth.js Configuration
# Generate a random secret for AUTH_SECRET:
# - Run: openssl rand -base64 32
# - Or visit: https://generate-secret.vercel.app/32
AUTH_SECRET=your-secret-key-here

# User ID Salt (Recommended for Production)
# Used to generate stable user IDs from email addresses.
# This ensures the same user gets the same ID across OAuth providers.
#
# IMPORTANT:
# - This value should NEVER be rotated once set in production
# - Changing this will cause all user IDs to change, breaking user data associations
# - If not set, AUTH_SECRET is used as fallback
# - Generate with: openssl rand -base64 32
#
# USER BEHAVIOR NOTE:
# - User IDs are tied to email addresses (user_<hash-of-email>)
# - If a user changes their email at the OAuth provider, they get a NEW user ID
# - This means they lose access to previous data (images, albums, tokens)
# - This is by design to maintain 1:1 email-to-identity relationship
#
# USER_ID_SALT=your-user-id-salt-here

# NextAuth URL (development)
# Production: Set this to your production domain (e.g., https://yourdomain.com)
NEXTAUTH_URL=http://localhost:3000

# GitHub OAuth Provider
# To obtain GitHub OAuth credentials:
# 1. Go to: https://github.com/settings/developers
# 2. Click "New OAuth App" or "New GitHub App"
# 3. Set Authorization callback URL to: http://localhost:3000/api/auth/callback/github
# 4. Copy Client ID and generate a Client Secret
GITHUB_ID=your-github-oauth-client-id
GITHUB_SECRET=your-github-oauth-client-secret

# Google OAuth Provider
# To obtain Google OAuth credentials:
# 1. Go to: https://console.cloud.google.com/
# 2. Create a new project or select existing one
# 3. Navigate to "APIs & Services" > "Credentials"
# 4. Click "Create Credentials" > "OAuth client ID"
# 5. Choose "Web application" as application type
# 6. Add authorized redirect URI: http://localhost:3000/api/auth/callback/google
# 7. Copy Client ID and Client Secret
GOOGLE_ID=your-google-oauth-client-id
GOOGLE_SECRET=your-google-oauth-client-secret

# E2E Test Authentication Bypass
# Secret value used to bypass authentication in E2E tests
# - Generate a random secret: openssl rand -base64 32
# - The secret is sent as 'x-e2e-auth-bypass' header by Playwright tests
#
# Configuration Required:
# 1. LOCAL DEVELOPMENT:
#    - Set this in .env.local when running: npm run test:e2e:local
#
# 2. GITHUB ACTIONS CI/CD:
#    - Add to GitHub Secrets: https://github.com/YOUR-ORG/YOUR-REPO/settings/secrets/actions
#    - Name: E2E_BYPASS_SECRET
#    - Value: Same random secret (openssl rand -base64 32)
#
# 3. VERCEL RUNTIME (REQUIRED):
#    - Add to Vercel Environment Variables: https://vercel.com/YOUR-TEAM/YOUR-PROJECT/settings/environment-variables
#    - Name: E2E_BYPASS_SECRET
#    - Value: Same random secret as GitHub
#    - Environments: ✅ Preview, ✅ Development, ❌ Production (DO NOT enable for production)
#
# Why Both GitHub and Vercel?
# - GitHub Secrets: Used during CI/CD build pipeline and E2E test execution
# - Vercel Environment Variables: Used by middleware at runtime on Vercel's edge network
#
# Security Features:
# - Production Protection: Bypass is BLOCKED in production even if secret is configured
#   (requires both NODE_ENV=production AND VERCEL_ENV=production to block)
# - Constant-time Comparison: Uses timingSafeEqual to prevent timing attacks
# - Audit Logging: All bypass attempts are logged with timestamp and environment info
#
# E2E_BYPASS_SECRET=your-e2e-bypass-secret-here

# Google AI (Gemini + Imagen)
# Get your API key from: https://aistudio.google.com/app/apikey
# Used for image analysis (Gemini) and enhancement (Imagen)
GEMINI_API_KEY=your-gemini-api-key-here
# IMAGEN_API_KEY may be the same as GEMINI_API_KEY
# IMAGEN_API_KEY=your-imagen-api-key-here

# Cloudflare R2 Storage
# To obtain Cloudflare R2 credentials:
# 1. Go to: https://dash.cloudflare.com/
# 2. Select your account
# 3. Navigate to R2 > Overview
# 4. Create a bucket (e.g., spike-land-images)
# 5. Go to "Manage R2 API Tokens" > Create API Token
# 6. Copy Account ID, Access Key ID, and Secret Access Key
CLOUDFLARE_ACCOUNT_ID=your-cloudflare-account-id
CLOUDFLARE_R2_ACCESS_KEY_ID=your-r2-access-key-id
CLOUDFLARE_R2_SECRET_ACCESS_KEY=your-r2-secret-access-key
CLOUDFLARE_R2_BUCKET_NAME=spike-land-images

# Cloudflare Images API
# Used for image transformation and CDN delivery
# Get credentials from: https://dash.cloudflare.com/ > Images
CLOUDFLARE_IMAGES_API_KEY=your-images-api-key
CLOUDFLARE_IMAGES_ACCOUNT_HASH=your-account-hash

# Stripe Payment Integration
# Get credentials from: https://dashboard.stripe.com/apikeys
# Start with test keys (sk_test_... and pk_test_...)
# STRIPE_SECRET_KEY=sk_test_your-stripe-secret-key
# NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_your-stripe-publishable-key
# STRIPE_WEBHOOK_SECRET=whsec_your-webhook-secret

# Rate Limiting (Optional - Upstash Redis)
# Get credentials from: https://console.upstash.com/
# UPSTASH_REDIS_REST_URL=https://your-redis-url.upstash.io
# UPSTASH_REDIS_REST_TOKEN=your-redis-token

# Error Tracking (Sentry - Optional)
# Get credentials from: https://sentry.io/
#
# Setup Instructions:
# 1. Create a Sentry account at https://sentry.io/
# 2. Create a new project (select "Next.js" platform)
# 3. Copy the DSN from the project settings
# 4. Add environment variables to Vercel:
#    - NEXT_PUBLIC_SENTRY_DSN (required for client-side tracking)
#    - SENTRY_DSN (required for server-side tracking, can be same as NEXT_PUBLIC_SENTRY_DSN)
#    - SENTRY_AUTH_TOKEN (optional, for source map uploads)
#    - SENTRY_ORG (optional, for source map uploads)
#    - SENTRY_PROJECT (optional, for source map uploads)
#    - SENTRY_ENVIRONMENT (optional, defaults to NODE_ENV)
#
# Note: Client-side DSN is public (NEXT_PUBLIC_*), server-side DSN is private
NEXT_PUBLIC_SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=production
# SENTRY_AUTH_TOKEN=your-sentry-auth-token (get from https://sentry.io/settings/account/api/auth-tokens/)
# SENTRY_ORG=your-organization-slug
# SENTRY_PROJECT=your-project-slug

# Resend Email Service
# Get API key from: https://resend.com/api-keys
# Used for transactional emails (welcome, purchase confirmations, etc.)
RESEND_API_KEY=re_your_resend_api_key_here
EMAIL_FROM=noreply@spike.land
